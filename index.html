<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />

    <!-- CSP é enviada via header pelo Helmet no servidor (com nonce dinâmico).
         Evite duplicar CSP via <meta> para não conflitar com o header. -->

    <!-- Mobile / viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />

    <title>Plataforma - Escola da Saúde</title>
    <meta name="description" content="Plataforma oficial da Escola da Saúde de Santos para inscrições, presença e certificados de eventos.">
    <meta name="author" content="Escola da Saúde de Santos">

    <!-- Aparência clara/escura -->
    <meta name="color-scheme" content="light dark">
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#14532d">
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#0b1f14">

    <!-- PWA / instalação -->
    <meta name="application-name" content="Escola da Saúde">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Escola da Saúde">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="/manifest.webmanifest">

    <!-- Segurança / UX -->
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <meta name="format-detection" content="telephone=no">

    <!-- Pré-conexões (fonts, Google login) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://accounts.google.com">
    <link rel="preconnect" href="https://www.gstatic.com" crossorigin>

    <!-- Fontes -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

    <!-- Ícones (fav + PWA) -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/icons/icon-192.png">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">

    <!-- Boot do tema (antes do render) -->
    <script nonce="{{CSP_NONCE}}">
      try {
        var saved = localStorage.getItem('theme'); // 'light' | 'dark' | null
        var systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        var theme = (saved === 'light' || saved === 'dark') ? saved : (systemPrefersDark ? 'dark' : 'light');
        var root = document.documentElement;
        if (theme === 'dark') root.classList.add('dark');
        else root.classList.remove('dark');
      } catch (e) { /* silencioso */ }
    </script>
  </head>

  <body class="bg-white text-gray-900 dark:bg-gray-900 dark:text-white font-sans min-h-screen">
    <noscript>É necessário habilitar JavaScript para usar esta aplicação.</noscript>

    <div id="root"></div>
    <div id="modal-root"></div>

    <script type="module" nonce="{{CSP_NONCE}}" src="/src/main.jsx"></script>
  </body>
</html>
