<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <title>GSI Test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="light dark" />

    <!-- Google Identity Services SDK -->
    <script
      src="https://accounts.google.com/gsi/client"
      async
      defer
      onload="console.log('[GSI-TEST] SDK carregado')"
      onerror="console.error('[GSI-TEST] ERRO carregando SDK')"
    ></script>

    <script>
      // üîê Mantenha a callback no escopo global (GSI necessita)
      window.handleCredentialResponse = (response) => {
        const ok = !!(response && response.credential);
        console.log("[GSI-TEST] credential recebida:", ok ? "OK (JWT)" : response);
        const box = document.getElementById("status");
        if (box) {
          box.textContent = ok
            ? "Login realizado com sucesso (verifique o console para o JWT)."
            : "Falha ao obter credencial.";
        }
      };

      // Apenas log informativo ao carregar a p√°gina
      window.addEventListener("DOMContentLoaded", () => {
        const el = document.getElementById("g_id_onload");
        console.log("[GSI-TEST] origin:", window.location.origin);
        console.log("[GSI-TEST] client_id:", el ? el.getAttribute("data-client_id") : "(n√£o encontrado)");
      });
    </script>

    <style>
      :root { --fg: #111827; --bg: #ffffff; }
      @media (prefers-color-scheme: dark) {
        :root { --fg: #f3f4f6; --bg: #111827; }
      }
      html, body {
        height: 100%;
        margin: 0;
        background: var(--bg);
        color: var(--fg);
        font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans", "Helvetica Neue", "Apple Color Emoji", "Segoe UI Emoji";
      }
      .container {
        min-height: 100%;
        display: grid;
        place-items: center;
        padding: 24px;
      }
      .card {
        width: 100%;
        max-width: 420px;
        border-radius: 14px;
        padding: 20px;
        background: color-mix(in srgb, var(--bg) 92%, var(--fg));
        box-shadow: 0 8px 30px rgba(0,0,0,.08);
      }
      h1 { font-size: 1.1rem; margin: 0 0 10px; }
      p { margin: 0 0 16px; opacity: .9; }
      #status {
        margin-top: 12px;
        font-size: .95rem;
        opacity: .9;
      }
      .visually-hidden {
        position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px;
        overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <main class="card" role="main" aria-labelledby="titulo">
        <h1 id="titulo">Teste de Login com Google Identity Services</h1>
        <p>Use o bot√£o abaixo para autenticar via Google. O JWT ser√° logado no console.</p>

        <!-- ‚öôÔ∏è Configura√ß√£o do GSI -->
        <div
          id="g_id_onload"
          data-client_id="73659622214-79kcta8d800n80ol3boj3b00r897k547.apps.googleusercontent.com"
          data-callback="handleCredentialResponse"
          data-auto_prompt="false">
        </div>

        <!-- üîò Bot√£o padr√£o do GSI -->
        <div class="g_id_signin" data-type="standard"></div>

        <!-- üì£ √Årea de status acess√≠vel -->
        <div id="status" role="status" aria-live="polite"></div>

        <!-- ‚ôøÔ∏è Fallback para JS desativado -->
        <noscript>
          <p role="note">Ative o JavaScript para usar o login Google.</p>
        </noscript>
      </main>
    </div>
  </body>
</html>
